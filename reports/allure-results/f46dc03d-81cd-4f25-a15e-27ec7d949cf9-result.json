{"name": "多轮对话 - 咨询洗发水", "status": "broken", "statusDetails": {"message": "UnicodeEncodeError: 'gbk' codec can't encode character '\\U0001f60a' in position 19: illegal multibyte sequence", "trace": "session_name = '咨询洗发水'\nmessages = [{'txt': '你好'}, {'txt': '推荐一款洗发水'}, {'txt': '这款多少钱'}]\n\n    @allure.feature(\"多轮对话\")\n    @pytest.mark.parametrize(\"session_name,messages\", test_chat_sessions)\n    def test_chat_session(session_name, messages):\n        \"\"\"\n        多轮对话测试：同一个用户连续发送多条消息\n        服务端根据 username 自动维护对话历史，客户端只需传当前消息\n        支持两种消息类型：\n        1. 普通文本消息: {\"txt\": \"你好\"}\n        2. 商品咨询消息: {\"txt\": \"商品链接\", \"product\": {\"id\": \"...\", \"title\": \"...\", \"url\": \"...\"}}\n        \"\"\"\n        allure.dynamic.story(session_name)\n        allure.dynamic.title(f\"多轮对话 - {session_name}\")\n    \n        username = generate_username()\n        allure.attach(username, name=\"用户名\", attachment_type=allure.attachment_type.TEXT)\n    \n        for i, msg in enumerate(messages, 1):\n            # 解析消息内容\n            if isinstance(msg, dict):\n                txt = msg['txt']\n                product = msg.get('product')\n            else:\n                txt = msg\n                product = None\n    \n            with allure.step(f\"第 {i} 轮对话: {txt[:30]}\"):\n                if product:\n                    allure.attach(\n                        json.dumps(product, ensure_ascii=False, indent=2),\n                        name=f\"第 {i} 轮 - 商品信息\",\n                        attachment_type=allure.attachment_type.JSON\n                    )\n    \n                allure.attach(txt, name=f\"第 {i} 轮 - 用户消息\", attachment_type=allure.attachment_type.TEXT)\n    \n                # 调用聊天接口\n                response = chat(txt, TOKEN, username, inquiry_product=product)\n                result = response.json()\n    \n                # 基础断言\n                assert result['code'] == 200, f\"接口返回异常: {result['message']}\"\n                assert result['message'] == 'success'\n                assert len(result['data']['ai_actions']) > 0, \"AI 没有返回任何回复\"\n    \n                # 提取并记录 AI 回复\n                full_reply = extract_reply(result)\n                assert len(full_reply) > 0, \"AI 回复内容为空\"\n                allure.attach(full_reply, name=f\"第 {i} 轮 - AI 回复\", attachment_type=allure.attachment_type.TEXT)\n>               print(f\"AI: {full_reply}\")\nE               UnicodeEncodeError: 'gbk' codec can't encode character '\\U0001f60a' in position 19: illegal multibyte sequence\n\ntest_chat.py:89: UnicodeEncodeError"}, "description": "\n    多轮对话测试：同一个用户连续发送多条消息\n    服务端根据 username 自动维护对话历史，客户端只需传当前消息\n    支持两种消息类型：\n    1. 普通文本消息: {\"txt\": \"你好\"}\n    2. 商品咨询消息: {\"txt\": \"商品链接\", \"product\": {\"id\": \"...\", \"title\": \"...\", \"url\": \"...\"}}\n    ", "steps": [{"name": "第 1 轮对话: 你好", "status": "broken", "statusDetails": {"message": "UnicodeEncodeError: 'gbk' codec can't encode character '\\U0001f60a' in position 19: illegal multibyte sequence\n", "trace": "  File \"E:\\code\\code-test-api\\Smart Growth\\test_chat.py\", line 89, in test_chat_session\n    print(f\"AI: {full_reply}\")\n"}, "attachments": [{"name": "第 1 轮 - 用户消息", "source": "15b34ee8-b3c8-4598-b6e7-cbf2f3174b05-attachment.txt", "type": "text/plain"}, {"name": "第 1 轮 - AI 回复", "source": "3c62067e-d311-424b-b973-dc6602e1124e-attachment.txt", "type": "text/plain"}], "start": 1770451432405, "stop": 1770451436980}], "attachments": [{"name": "用户名", "source": "1525ddcf-7ebe-49ed-9cc5-f827f88f310f-attachment.txt", "type": "text/plain"}], "parameters": [{"name": "session_name", "value": "'咨询洗发水'"}, {"name": "messages", "value": "[{'txt': '你好'}, {'txt': '推荐一款洗发水'}, {'txt': '这款多少钱'}]"}], "start": 1770451432405, "stop": 1770451436982, "uuid": "5f64c972-50b3-4db8-8312-d7dfc9174331", "historyId": "22f5e8c479e128272bf1f85d4cca6a24", "testCaseId": "15ecd199b6c93104b322a0329e37a8d4", "fullName": "test_chat#test_chat_session", "labels": [{"name": "story", "value": "咨询洗发水"}, {"name": "feature", "value": "多轮对话"}, {"name": "suite", "value": "test_chat"}, {"name": "host", "value": "WIN-VO7C9Q1F77H"}, {"name": "thread", "value": "42900-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "test_chat"}]}